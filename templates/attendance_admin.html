{% extends "base.html" %}
{% block content %}
<h1 class="text-3xl font-bold mb-6">Attendance Records</h1>
<div class="bg-white p-4 rounded-lg shadow-sm mb-6">
    <form method="GET" class="flex flex-wrap gap-4 items-end">
        <div>
            <label class="block text-sm text-gray-600 mb-1">Date</label>
            <input type="date" name="date" class="border p-2 rounded w-full" value="{{ request.args.get('date', '') }}">
        </div>
        <div>
            <label class="block text-sm text-gray-600 mb-1">Member</label>
            <select name="member" class="border p-2 rounded w-full">
                <option value="">All Members</option>
                {% for u in users %}
                <option value="{{ u.username }}" {% if request.args.get('member') == u.username %}selected{% endif %}>{{ u.username }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label class="block text-sm text-gray-600 mb-1">Department</label>
            <select name="department" class="border p-2 rounded w-full">
                <option value="">All Departments</option>
                {% for d in departments %}
                <option value="{{ d }}" {% if request.args.get('department') == d %}selected{% endif %}>{{ d }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full md:w-auto">Filter</button>
        <a href="/attendance" class="text-gray-500 hover:underline px-2 py-2">Clear</a>
    </form>
</div>

<div class="bg-white rounded-lg shadow-sm overflow-x-auto">
    <table class="w-full text-left border-collapse min-w-[600px]">
        <thead>
            <tr class="bg-gray-50 border-b">
                <th class="p-4">Date</th>
                <th class="p-4">Username</th>
                <th class="p-4">Time In</th>
                <th class="p-4">Time Out</th>
                <th class="p-4">Total Hours</th>
            </tr>
        </thead>
        <tbody>
            {% for record in records|reverse %}
            <tr class="border-b hover:bg-gray-50">
                <td class="p-4">{{ record.date }}</td>
                <td class="p-4 font-semibold">{{ record.username }}</td>
                <td class="p-4">{{ record.time_in }}</td>
                <td class="p-4">{{ record.time_out or '-' }}</td>
                <td class="p-4 font-bold">{{ record.total_hours }}</td>
            </tr>
            {% else %}
            <tr><td colspan="5" class="p-4 text-center text-gray-500">No records found.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
